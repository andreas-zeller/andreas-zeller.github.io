
<!DOCTYPE html>


<html lang="en" data-content_root="./" >

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>Data Generators and Fakers &#8212; Fuzzing with Fandango</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "";
  </script>
  <!--
    this give us a css class that will be invisible only if js is disabled
  -->
  <noscript>
    <style>
      .pst-js-only { display: none !important; }

    </style>
  </noscript>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="_static/styles/theme.css?digest=8878045cc6db502f8baf" rel="stylesheet" />
<link href="_static/styles/pydata-sphinx-theme.css?digest=8878045cc6db502f8baf" rel="stylesheet" />

    <link rel="stylesheet" type="text/css" href="_static/pygments.css?v=fa44fd50" />
    <link rel="stylesheet" type="text/css" href="_static/styles/sphinx-book-theme.css?v=a3416100" />
    <link rel="stylesheet" type="text/css" href="_static/togglebutton.css?v=13237357" />
    <link rel="stylesheet" type="text/css" href="_static/copybutton.css?v=76b2166b" />
    <link rel="stylesheet" type="text/css" href="_static/mystnb.4510f1fc1dee50b3e5859aac5469c37c29e427902b24a333a5f9fcb2f0b3ac41.css" />
    <link rel="stylesheet" type="text/css" href="_static/sphinx-thebe.css?v=4fa983c6" />
    <link rel="stylesheet" type="text/css" href="_static/sphinx-design.min.css?v=95c83b7e" />
  
  <!-- So that users can add custom icons -->
  <script src="_static/scripts/fontawesome.js?digest=8878045cc6db502f8baf"></script>
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="_static/scripts/bootstrap.js?digest=8878045cc6db502f8baf" />
<link rel="preload" as="script" href="_static/scripts/pydata-sphinx-theme.js?digest=8878045cc6db502f8baf" />

    <script src="_static/documentation_options.js?v=9eb32ce0"></script>
    <script src="_static/doctools.js?v=9a2dae69"></script>
    <script src="_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="_static/clipboard.min.js?v=a7894cd8"></script>
    <script src="_static/copybutton.js?v=f281be69"></script>
    <script src="_static/scripts/sphinx-book-theme.js?v=887ef09a"></script>
    <script>let toggleHintShow = 'Click to show';</script>
    <script>let toggleHintHide = 'Click to hide';</script>
    <script>let toggleOpenOnPrint = 'true';</script>
    <script src="_static/togglebutton.js?v=4a39c7ea"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script src="_static/design-tabs.js?v=f930bc37"></script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"; const thebe_selector = ".thebe,.cell"; const thebe_selector_input = "pre"; const thebe_selector_output = ".output, .cell_output"</script>
    <script async="async" src="_static/sphinx-thebe.js?v=c100c467"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"; const thebe_selector = ".thebe,.cell"; const thebe_selector_input = "pre"; const thebe_selector_output = ".output, .cell_output"</script>
    <script>window.MathJax = {"options": {"processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
    <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script>DOCUMENTATION_OPTIONS.pagename = 'Generators';</script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="Complex Input Structures" href="Recursive.html" />
    <link rel="prev" title="The Fandango Shell" href="Shell.html" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="docsearch:language" content="en"/>
  <meta name="docsearch:version" content="" />
  </head>
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="">

  
  
  <div id="pst-skip-link" class="skip-link d-print-none"><a href="#main-content">Skip to main content</a></div>
  
  <div id="pst-scroll-pixel-helper"></div>
  
  <button type="button" class="btn rounded-pill" id="pst-back-to-top">
    <i class="fa-solid fa-arrow-up"></i>Back to top</button>

  
  <dialog id="pst-search-dialog">
    
<form class="bd-search d-flex align-items-center"
      action="search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         placeholder="Search this book..."
         aria-label="Search this book..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form>
  </dialog>

  <div class="pst-async-banner-revealer d-none">
  <aside id="bd-header-version-warning" class="d-none d-print-none" aria-label="Version warning"></aside>
</div>

  
    <header class="bd-header navbar navbar-expand-lg bd-navbar d-print-none">
    </header>
  

  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      
      
      <dialog id="pst-primary-sidebar-modal"></dialog>
      <div id="pst-primary-sidebar" class="bd-sidebar-primary bd-sidebar">
        

  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
    
    
  </div>
  
    <div class="sidebar-primary-items__start sidebar-primary__section">
        <div class="sidebar-primary-item">

  
    
  

<a class="navbar-brand logo" href="Intro.html">
  
  
  
  
  
    
    
      
    
    
    <img src="_static/fandango.png" class="logo__image only-light" alt="Fuzzing with Fandango - Home"/>
    <img src="_static/fandango.png" class="logo__image only-dark pst-js-only" alt="Fuzzing with Fandango - Home"/>
  
  
</a></div>
        <div class="sidebar-primary-item">

<button class="btn search-button-field search-button__button pst-js-only" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
 <i class="fa-solid fa-magnifying-glass"></i>
 <span class="search-button__default-text">Search</span>
 <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd class="kbd-shortcut__modifier">K</kbd></span>
</button></div>
        <div class="sidebar-primary-item"><nav class="bd-links bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item navbar-nav active">
        
        <ul class="nav bd-sidenav bd-sidenav__home-link">
            <li class="toctree-l1">
                <a class="reference internal" href="Intro.html">
                    Fuzzing with Fandango
                </a>
            </li>
        </ul>
        <p aria-level="2" class="caption" role="heading"><span class="caption-text">About Fandango</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="About.html">About Fandango</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Fandango Tutorial</span></p>
<ul class="current nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="Tutorial.html">Fandango Tutorial</a></li>
<li class="toctree-l1"><a class="reference internal" href="Setup.html">Installing Fandango</a></li>
<li class="toctree-l1"><a class="reference internal" href="FirstSpec.html">A First Fandango Spec</a></li>
<li class="toctree-l1"><a class="reference internal" href="Invoking.html">Invoking Fandango</a></li>
<li class="toctree-l1"><a class="reference internal" href="Fuzzing.html">Fuzzing with Fandango</a></li>
<li class="toctree-l1"><a class="reference internal" href="Strategies.html">Some Fuzzing Strategies</a></li>
<li class="toctree-l1"><a class="reference internal" href="Constraints.html">Shaping Inputs with Constraints</a></li>
<li class="toctree-l1"><a class="reference internal" href="Shell.html">The Fandango Shell</a></li>
<li class="toctree-l1 current active"><a class="current reference internal" href="#">Data Generators and Fakers</a></li>
<li class="toctree-l1"><a class="reference internal" href="Recursive.html">Complex Input Structures</a></li>
<li class="toctree-l1"><a class="reference internal" href="Paths.html">Accessing Input Elements</a></li>
<li class="toctree-l1"><a class="reference internal" href="ISO8601.html">Case Study: ISO 8601 Date + Time</a></li>
<li class="toctree-l1"><a class="reference internal" href="Binary.html">Generating Binary Inputs</a></li>
<li class="toctree-l1"><a class="reference internal" href="Bits.html">Bits and Bit Fields</a></li>
<li class="toctree-l1"><a class="reference internal" href="Gif.html">Case Study: The GIF Format</a></li>
<li class="toctree-l1"><a class="reference internal" href="Distributions.html">Statistical Distributions</a></li>
<li class="toctree-l1"><a class="reference internal" href="Whitebox.html">Coverage-Guided Fuzzing</a></li>
<li class="toctree-l1"><a class="reference internal" href="Hatching.html">Hatching Specs</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Fandango Reference</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="Reference.html">Fandango Reference</a></li>
<li class="toctree-l1"><a class="reference internal" href="Installing.html">Installing Fandango</a></li>
<li class="toctree-l1"><a class="reference internal" href="Stdlib.html">Fandango Standard Library</a></li>
<li class="toctree-l1"><a class="reference internal" href="Including.html">Fandango Spec Locations</a></li>
</ul>

    </div>
</nav></div>
    </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
      <div class="sidebar-primary-item">
<div id="ethical-ad-placement"
      class="flat"
      data-ea-publisher="readthedocs"
      data-ea-type="readthedocs-sidebar"
      data-ea-manual="true">
</div></div>
  </div>


      </div>
      
      <main id="main-content" class="bd-main" role="main">
        
        

<div class="sbt-scroll-pixel-helper"></div>

          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article d-print-none">
<div class="header-article-items header-article__inner">
  
    <div class="header-article-items__start">
      
        <div class="header-article-item"><button class="sidebar-toggle primary-toggle btn btn-sm" title="Toggle primary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
  <span class="fa-solid fa-bars"></span>
</button></div>
      
    </div>
  
  
    <div class="header-article-items__end">
      
        <div class="header-article-item">

<div class="article-header-buttons">





<div class="dropdown dropdown-download-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Download this page">
    <i class="fas fa-download"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="_sources/Generators.md" target="_blank"
   class="btn btn-sm btn-download-source-button dropdown-item"
   title="Download source file"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file"></i>
  </span>
<span class="btn__text-container">.md</span>
</a>
</li>
      
      
      
      
      <li>
<button onclick="window.print()"
  class="btn btn-sm btn-download-pdf-button dropdown-item"
  title="Print to PDF"
  data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file-pdf"></i>
  </span>
<span class="btn__text-container">.pdf</span>
</button>
</li>
      
  </ul>
</div>




<button onclick="toggleFullScreen()"
  class="btn btn-sm btn-fullscreen-button"
  title="Fullscreen mode"
  data-bs-placement="bottom" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-expand"></i>
  </span>

</button>



<button class="btn btn-sm nav-link pst-navbar-icon theme-switch-button pst-js-only" aria-label="Color mode" data-bs-title="Color mode"  data-bs-placement="bottom" data-bs-toggle="tooltip">
  <i class="theme-switch fa-solid fa-sun                fa-lg" data-mode="light" title="Light"></i>
  <i class="theme-switch fa-solid fa-moon               fa-lg" data-mode="dark"  title="Dark"></i>
  <i class="theme-switch fa-solid fa-circle-half-stroke fa-lg" data-mode="auto"  title="System Settings"></i>
</button>


<button class="btn btn-sm pst-navbar-icon search-button search-button__button pst-js-only" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass fa-lg"></i>
</button>
<button class="sidebar-toggle secondary-toggle btn btn-sm" title="Toggle secondary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="fa-solid fa-list"></span>
</button>
</div></div>
      
    </div>
  
</div>
</div>
              
              

<div id="jb-print-docs-body" class="onlyprint">
    <h1>Data Generators and Fakers</h1>
    <!-- Table of contents -->
    <div id="print-main-content">
        <div id="jb-print-toc">
            
            <div>
                <h2> Contents </h2>
            </div>
            <nav aria-label="Page">
                <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#augmenting-grammars-with-data">Augmenting Grammars with Data</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#using-fakers">Using Fakers</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#number-generators">Number Generators</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#generators-and-random-productions">Generators and Random Productions</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#combining-generators-and-constraints">Combining Generators and Constraints</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#when-to-use-generators-and-when-constraints">When to use Generators, and when Constraints</a></li>
</ul>
            </nav>
        </div>
    </div>
</div>

              
                
<div id="searchbox"></div>
                <article class="bd-article">
                  
  <section class="tex2jax_ignore mathjax_ignore" id="data-generators-and-fakers">
<span id="sec-generators"></span><h1>Data Generators and Fakers<a class="headerlink" href="#data-generators-and-fakers" title="Link to this heading">#</a></h1>
<p>Often, you don’t want to generate <em>totally</em> random data; it suffices that <em>some</em> aspects of it are random.
This naturally raises the question: Where can one get non-random, <em>natural</em> data from, and how can one integrate this into Fandango?</p>
<section id="augmenting-grammars-with-data">
<h2>Augmenting Grammars with Data<a class="headerlink" href="#augmenting-grammars-with-data" title="Link to this heading">#</a></h2>
<p>The straightforward solution would be to simply extend our grammar with more natural data.
In order to obtain more natural first and last names in our <a class="reference internal" href="Fuzzing.html#sec-fuzzing"><span class="std std-ref">ongoing names/age example</span></a>, for instance, we could simply extend the <a class="reference download internal" download="" href="_downloads/eb75cca3f691010aefb22548a3d912ba/persons.fan"><span class="xref download myst"><code class="docutils literal notranslate"><span class="pre">persons.fan</span></code></span></a> rule</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">&lt;</span><span class="n">first_name</span><span class="o">&gt;</span> <span class="p">:</span><span class="o">:=</span> <span class="o">&lt;</span><span class="n">name</span><span class="o">&gt;</span><span class="p">;</span>
</pre></div>
</div>
<p>to</p>
<aside class="margin sidebar">
<p class="sidebar-title"></p>
<p>These are the given names on <a class="reference external" href="https://en.wikipedia.org/wiki/Pablo_Picasso">Pablo Picasso</a>’s birth certificate.</p>
</aside>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">&lt;</span><span class="n">first_name</span><span class="o">&gt;</span> <span class="p">:</span><span class="o">:=</span> <span class="o">&lt;</span><span class="n">name</span><span class="o">&gt;</span> <span class="o">|</span> <span class="s2">&quot;Alice&quot;</span> <span class="o">|</span> <span class="s2">&quot;Bob&quot;</span> <span class="o">|</span> <span class="s2">&quot;Eve&quot;</span> <span class="o">|</span> <span class="s2">&quot;Pablo Diego José Francisco de Paula Juan Nepomuceno Cipriano de la Santísima Trinidad&quot;</span><span class="p">;</span>
</pre></div>
</div>
<p>and extend the rule</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">&lt;</span><span class="n">last_name</span><span class="o">&gt;</span> <span class="p">:</span><span class="o">:=</span> <span class="o">&lt;</span><span class="n">name</span><span class="o">&gt;</span><span class="p">;</span>
</pre></div>
</div>
<p>to, say,</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">&lt;</span><span class="n">last_name</span><span class="o">&gt;</span> <span class="p">:</span><span class="o">:=</span> <span class="o">&lt;</span><span class="n">name</span><span class="o">&gt;</span> <span class="o">|</span> <span class="s2">&quot;Doe&quot;</span> <span class="o">|</span> <span class="s2">&quot;Smith&quot;</span> <span class="o">|</span> <span class="s2">&quot;Ruiz Picasso&quot;</span><span class="p">;</span>
</pre></div>
</div>
<p>then we can have Fandango create names such as</p>
<div class="cell tag_remove-input docutils container">
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>                                                                               
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Bdpk Smith,15
Bob Smith,0035
Zampxf Klvm,544
Eve Ruiz Picasso,68
Pablo Diego José Francisco de Paula Juan Nepomuceno Cipriano de la Santísima Trinidad Smith,20
Eve Ruiz Picasso,3448
Dtcn Doe,77923
Unrzhw Smith,5
Eve Ruiz Picasso,3436
Pablo Diego José Francisco de Paula Juan Nepomuceno Cipriano de la Santísima Trinidad Ruiz Picasso,8
</pre></div>
</div>
</div>
</div>
<p>Note that we still get a few “random” names; this comes as specified by our rules.
By default, Fandango picks each alternative with equal likelihood, so there is a 20% chance for the first name and a 25% chance for the last name to be completely random.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Future Fandango versions will have means to control these likelihoods.</p>
</div>
</section>
<section id="using-fakers">
<h2>Using Fakers<a class="headerlink" href="#using-fakers" title="Link to this heading">#</a></h2>
<p>Frequently, there already are data sources available that you’d like to reuse – and converting each of their elements into a grammar alternative is inconvenient.
That is why Fandango allows you to <em>specify a data source as part of the grammar</em> - as a <em>Python function</em> that supplies the respective value.
Let us illustrate this with an example.</p>
<p>The Python <code class="docutils literal notranslate"><span class="pre">faker</span></code> module is a great source of “natural” data, providing “fake” data for names, addresses, credit card numbers, and more.</p>
<p>Here’s an example of how to use it:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">faker</span> <span class="kn">import</span> <span class="n">Faker</span>
<span class="n">fake</span> <span class="o">=</span> <span class="n">Faker</span><span class="p">()</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">10</span><span class="p">):</span>
  <span class="nb">print</span><span class="p">(</span><span class="n">fake</span><span class="o">.</span><span class="n">first_name</span><span class="p">())</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Robert
Lindsay
Michael
Jasmine
William
Philip
Mary
Jose
Wendy
Jose
</pre></div>
</div>
</div>
</div>
<p>Have a look at the <a class="reference external" href="https://faker.readthedocs.io/"><code class="docutils literal notranslate"><span class="pre">faker</span></code> documentation</a> to see all the fake data it can produce.
The methods <code class="docutils literal notranslate"><span class="pre">first_name()</span></code> and <code class="docutils literal notranslate"><span class="pre">last_name()</span></code> are what we need.
The idea is to extend the <code class="docutils literal notranslate"><span class="pre">&lt;first_name&gt;</span></code> and <code class="docutils literal notranslate"><span class="pre">&lt;last_name&gt;</span></code> rules such that they can draw on the <code class="docutils literal notranslate"><span class="pre">faker</span></code> functions.
To do so, in Fandango, you can simply extend the grammar as follows:</p>
<aside class="margin sidebar">
<p class="sidebar-title"></p>
<p>A generator applies to <em>all</em> alternatives, not just the last one.</p>
</aside>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">&lt;</span><span class="n">first_name</span><span class="o">&gt;</span> <span class="p">:</span><span class="o">:=</span> <span class="o">&lt;</span><span class="n">name</span><span class="o">&gt;</span> <span class="o">:=</span> <span class="n">fake</span><span class="o">.</span><span class="n">first_name</span><span class="p">();</span>
</pre></div>
</div>
<aside class="margin sidebar">
<p class="sidebar-title"></p>
<p><code class="docutils literal notranslate"><span class="pre">:=</span></code> is the assignment operator in several programming languages; in Python, it can be used to assign values within expressions.</p>
</aside>
<p>The <em>generator</em> <code class="docutils literal notranslate"><span class="pre">:=</span> <span class="pre">EXPR</span></code> <em>assigns</em> the value produced by the expression <code class="docutils literal notranslate"><span class="pre">EXPR</span></code> (in our case, <code class="docutils literal notranslate"><span class="pre">fake.first_name()</span></code>) to the symbol on the left-hand side of the rule (in our case, <code class="docutils literal notranslate"><span class="pre">&lt;first_name&gt;</span></code>).</p>
<p>We can do the same for the last name, too; and then this is the full Fandango spec <a class="reference download internal" download="" href="_downloads/6449eb07859146fcf82907493793d86e/persons-faker.fan"><span class="xref download myst">persons-faker.fan</span></a>:</p>
<div class="cell tag_remove-input docutils container">
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>from faker import Faker
fake = Faker()

include(&#39;persons.fan&#39;)

&lt;first_name&gt; ::= &lt;name&gt; := fake.first_name();
&lt;last_name&gt; ::= &lt;name&gt; := fake.last_name();
</pre></div>
</div>
</div>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>The <a class="reference internal" href="Including.html#sec-including"><span class="std std-ref">Fandango <code class="docutils literal notranslate"><span class="pre">include()</span></code> function</span></a> <em>includes</em> the Fandango definitions of the given file.
This way, we need not repeat the definitions from <code class="docutils literal notranslate"><span class="pre">persons.fan</span></code> and only focus on the differences.</p>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Python code (from Python files) that you use in a generator (or in a constraint, for that matter) needs to be imported.
Use the Python <code class="docutils literal notranslate"><span class="pre">import</span></code> features to do that.</p>
</div>
<div class="admonition attention">
<p class="admonition-title">Attention</p>
<p><code class="docutils literal notranslate"><span class="pre">include(FILE)</span></code> is for Fandango files, <code class="docutils literal notranslate"><span class="pre">import</span> <span class="pre">MODULE</span></code> is for Python modules.</p>
</div>
<p>This is what the output of the above spec looks like:</p>
<div class="cell tag_remove-input docutils container">
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>                                                                               
April Hunt,8
Matthew Abbott,87
Heather Eaton,02
Cole Jackson,84
Joshua Shaffer,26
Sheena Hickman,67
Diana Lloyd,175
Bradley Donovan,30
Eric Stein,2752
April Barron,27
</pre></div>
</div>
</div>
</div>
<p>You see that all first and last names now stem from the Faker library.</p>
</section>
<section id="number-generators">
<h2>Number Generators<a class="headerlink" href="#number-generators" title="Link to this heading">#</a></h2>
<p>In the above output, the “age” fields are still very random, though.
With generators, we can achieve much more natural distributions.</p>
<p>After importing the Python <code class="docutils literal notranslate"><span class="pre">random</span></code> module:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">random</span>
</pre></div>
</div>
<p>we can make use of <a class="reference external" href="https://docs.python.org/3/library/random.html">dozens of random number functions</a> to use as generators.
For instance, <code class="docutils literal notranslate"><span class="pre">random.randint(A,</span> <span class="pre">B)</span></code> return a random integer <span class="math notranslate nohighlight">\(n\)</span> such that <span class="math notranslate nohighlight">\(A \le n \le B\)</span> holds.
To obtain a range of ages between 25 and 35, we can thus write:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">&lt;</span><span class="n">age</span><span class="o">&gt;</span> <span class="p">:</span><span class="o">:=</span> <span class="o">&lt;</span><span class="n">digit</span><span class="o">&gt;+</span> <span class="o">:=</span> <span class="nb">str</span><span class="p">(</span><span class="n">random</span><span class="o">.</span><span class="n">randint</span><span class="p">(</span><span class="mi">25</span><span class="p">,</span> <span class="mi">35</span><span class="p">));</span>
</pre></div>
</div>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>All Fandango generators must return strings.
Use <code class="docutils literal notranslate"><span class="pre">str()</span></code> to convert numbers into strings.</p>
</div>
<p>The resulting <a class="reference download internal" download="" href="_downloads/22db315d6c7c283d43c6fb1e355624fe/persons-faker-age.fan"><span class="xref download myst">Fandango spec file</span></a> produces the desired range of ages:</p>
<div class="cell tag_remove-input docutils container">
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>                                                                               
Nathan Hill,32
Scott Adams,35
Melissa Riley,28
Brandi Davis,31
Janet Campbell,25
Jose James,34
Mary Davila,35
Jessica Anderson,26
Katrina Meza,26
Carl King,33
</pre></div>
</div>
</div>
</div>
<p>We can also create a Gaussian (normal) distribution this way:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">&lt;</span><span class="n">age</span><span class="o">&gt;</span> <span class="p">:</span><span class="o">:=</span> <span class="o">&lt;</span><span class="n">digit</span><span class="o">&gt;+</span> <span class="o">:=</span> <span class="nb">str</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">random</span><span class="o">.</span><span class="n">gauss</span><span class="p">(</span><span class="mi">35</span><span class="p">)));</span>
</pre></div>
</div>
<p><code class="docutils literal notranslate"><span class="pre">random.gauss()</span></code> returns floating point numbers.
However, the final value must fit the given symbol rules (in our case, <code class="docutils literal notranslate"><span class="pre">&lt;digit&gt;+</span></code>), so we convert the age into an integer (<code class="docutils literal notranslate"><span class="pre">int()</span></code>).</p>
<p>These are the ages we get this way:</p>
<div class="cell tag_remove-input docutils container">
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>                                                                               
Larry Miller,34
Shawn Smith,34
Taylor Duarte,35
James Brown,36
Mark Wang,35
Nicole Ponce,35
Stephanie Ayers,35
Alexander Benton,34
Kenneth Johnson,33
Jennifer Turner,34
</pre></div>
</div>
</div>
</div>
<p>In <a class="reference internal" href="Distributions.html#sec-distributions"><span class="std std-ref">Statistical Distributions</span></a>, we will introduce more ways to obtain specific distributions.</p>
</section>
<section id="generators-and-random-productions">
<h2>Generators and Random Productions<a class="headerlink" href="#generators-and-random-productions" title="Link to this heading">#</a></h2>
<p>In testing, you want to have a good balance between <em>common</em> and <em>uncommon</em> inputs:</p>
<ul class="simple">
<li><p>Common inputs are important because they represent the typical usage, and you don’t want your program to fail there;</p></li>
<li><p>Uncommon inputs are important because they uncover bugs you may <em>not</em> find during alpha or beta testing, and thus avoid latent bugs (and vulnerabilities!) slipping into production.</p></li>
</ul>
<p>We can easily achieve such a mix by adding rules such as</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">&lt;</span><span class="n">first_name</span><span class="o">&gt;</span> <span class="p">:</span><span class="o">:=</span> <span class="o">&lt;</span><span class="n">name</span><span class="o">&gt;</span> <span class="o">|</span> <span class="o">&lt;</span><span class="n">natural_name</span><span class="o">&gt;</span><span class="p">;</span>
<span class="o">&lt;</span><span class="n">natural_name</span><span class="o">&gt;</span> <span class="p">:</span><span class="o">:=</span> <span class="o">&lt;</span><span class="n">name</span><span class="o">&gt;</span> <span class="o">:=</span> <span class="n">fake</span><span class="o">.</span><span class="n">first_name</span><span class="p">();</span>
</pre></div>
</div>
<p>With this, both random names (<code class="docutils literal notranslate"><span class="pre">&lt;name&gt;</span></code>) and natural names (<code class="docutils literal notranslate"><span class="pre">&lt;natural_name&gt;</span></code>) will have a chance of 50% to be produced:</p>
<div class="cell tag_remove-input docutils container">
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>                                                                               
James Cox,7
Yuclc Dean,9130
Sxdtpv Brown,86
Lvh Nichols,410
Teresa Gonzales,0
Hfey Jones,8
Christina Jackson,93
Suzanne Ruiz,3
Alex Simmons,94
Melissa Jones,4688
</pre></div>
</div>
</div>
</div>
</section>
<section id="combining-generators-and-constraints">
<span id="sec-generators-and-constraints"></span><h2>Combining Generators and Constraints<a class="headerlink" href="#combining-generators-and-constraints" title="Link to this heading">#</a></h2>
<p>When using a generator, why does one still have to specify the format of the data, say <code class="docutils literal notranslate"><span class="pre">&lt;name&gt;</span></code>?
This is so for two reasons:</p>
<aside class="margin sidebar">
<p class="sidebar-title"></p>
<p>To allow access to the elements of the generator output, Fandango <em>parses</em> the output according to the symbol rules.</p>
</aside>
<ol class="arabic simple">
<li><p>It allows the Fandango spec to be used for <em>parsing</em> existing data, and consequently, <em>mutating</em> it;</p></li>
<li><p>It allows additional <a class="reference internal" href="Constraints.html"><span class="std std-doc"><em>constraints</em></span></a> to be applied on the generator result and its elements.</p></li>
</ol>
<p>In our example, the latter can be used to further narrow down the set of names.
If we want all last names to start with an <code class="docutils literal notranslate"><span class="pre">S</span></code>, for instance, we can invoke Fandango as</p>
<aside class="margin sidebar">
<p class="sidebar-title"></p>
<p>Grammar symbols <code class="docutils literal notranslate"><span class="pre">&lt;...&gt;</span></code> support all <a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#string-methods">Python string methods</a>.</p>
</aside>
<div class="highlight-shell notranslate"><div class="highlight"><pre><span></span>$<span class="w"> </span>fandango<span class="w"> </span>fuzz<span class="w"> </span>-f<span class="w"> </span>persons-faker.fan<span class="w"> </span>-c<span class="w"> </span><span class="s1">&#39;&lt;last_name&gt;.startswith(&quot;S&quot;)&#39;</span><span class="w"> </span>-n<span class="w"> </span><span class="m">10</span>
</pre></div>
</div>
<p>and we get</p>
<div class="cell tag_remove-input docutils container">
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>                                                                               
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Heather Stout,05
Lauren Scott,66
Cynthia Stewart,4
William Santiago,18
Kimberly Stephens,9356
Andrea Spencer,92
Christopher Sanders,19
Heather Stout,05
Lauren Scott,66
Cynthia Stewart,4
</pre></div>
</div>
</div>
</div>
</section>
<section id="when-to-use-generators-and-when-constraints">
<h2>When to use Generators, and when Constraints<a class="headerlink" href="#when-to-use-generators-and-when-constraints" title="Link to this heading">#</a></h2>
<p>One might assume that instead of a generator, one could also use a <em>constraint</em> to achieve the same effect. So, couldn’t one simply add a constraint that says</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">&lt;</span><span class="n">first_name</span><span class="o">&gt;</span> <span class="o">==</span> <span class="n">fake</span><span class="o">.</span><span class="n">first_name</span><span class="p">();</span>
</pre></div>
</div>
<aside class="margin sidebar">
<p class="sidebar-title"></p>
<p>In case this should work, this is only through some internal Fandango optimization that directly assigns computed values to symbols.</p>
</aside>
<p>Unfortunately, this does not work.</p>
<p>The reason is that the faker returns <em>a different value</em> every time it is invoked, making it hard for Fandango to solve the constraint.
Remember that Fandango solves constraints by applying mutations to a population, getting closer to the target with each iteration.
If the target keeps on changing, the algorithm will lose guidance and will not progress towards the solution.</p>
<p>Likewise, in contrast to our example in <a class="reference internal" href="#sec-generators-and-constraints"><span class="std std-ref">Combining Generators and Constraints</span></a>, one may think about using a <em>constraint</em> to set a limit to a number, say:</p>
<div class="highlight-shell notranslate"><div class="highlight"><pre><span></span>$<span class="w"> </span>fandango<span class="w"> </span>fuzz<span class="w"> </span>-f<span class="w"> </span>persons-faker.fan<span class="w"> </span>-c<span class="w"> </span><span class="s1">&#39;str(&lt;last_name&gt;).startswith(&quot;S&quot;)&#39;</span><span class="w"> </span>-c<span class="w"> </span><span class="s1">&#39;int(&lt;age&gt;) &gt;= 25 and int(&lt;age&gt;) &lt;= 35&#39;</span><span class="w"> </span>-n<span class="w"> </span><span class="m">10</span>
</pre></div>
</div>
<p>This would work:</p>
<div class="cell tag_remove-input docutils container">
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>💃 <span class=" -Color -Color-C124">Fandango </span> 1/500 <span class=" -Color -Color-BGC46">      </span><span class=" -Color -Color-BGC106">                           </span><span class=" -Color -Color-BGC100">      </span><span class=" -Color -Color-BGC166">                     </span>
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>                                                                               
Brandy Strickland,34
Brandy Strickland,34
Brandy Strickland,34
Ralph Serrano,34
Nathan Small,31
Brandy Strickland,34
Michael Scott,31
Taylor Schmidt,26
Brandy Strickoand,34
Brandy Strickland,34
</pre></div>
</div>
</div>
</div>
<p>But while the values will fit the constraint, they will not be randomly distributed.
This is because Fandango treats and generates them as <em>strings</em> (= sequences of digits), ignoring thur semantics as numerical values.
To obtain well-distributed numbers from the beginning, use a generator.</p>
<ol class="arabic simple">
<li><p>If a value to be produced is <em>random</em>, it should be added via a <em>generator</em>.</p></li>
<li><p>If a value to be produced is <em>constant</em>, it can go into a <em>generator</em> or a <em>constraint</em>.</p></li>
<li><p>If a value to be produced must be <em>part of a valid input</em>, it should go into a <em>constraint</em>. (Constraints are checked during parsing <em>and</em> production.)</p></li>
</ol>
<div class="docutils">
</div>
</section>
</section>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            name: "python3",
            path: "./."
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

                </article>
              

              
              
              
              
                <footer class="prev-next-footer d-print-none">
                  
<div class="prev-next-area">
    <a class="left-prev"
       href="Shell.html"
       title="previous page">
      <i class="fa-solid fa-angle-left"></i>
      <div class="prev-next-info">
        <p class="prev-next-subtitle">previous</p>
        <p class="prev-next-title">The Fandango Shell</p>
      </div>
    </a>
    <a class="right-next"
       href="Recursive.html"
       title="next page">
      <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title">Complex Input Structures</p>
      </div>
      <i class="fa-solid fa-angle-right"></i>
    </a>
</div>
                </footer>
              
            </div>
            
            
              
                <dialog id="pst-secondary-sidebar-modal"></dialog>
                <div id="pst-secondary-sidebar" class="bd-sidebar-secondary bd-toc"><div class="sidebar-secondary-items sidebar-secondary__inner">


  <div class="sidebar-secondary-item">
  <div class="page-toc tocsection onthispage">
    <i class="fa-solid fa-list"></i> Contents
  </div>
  <nav class="bd-toc-nav page-toc">
    <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#augmenting-grammars-with-data">Augmenting Grammars with Data</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#using-fakers">Using Fakers</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#number-generators">Number Generators</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#generators-and-random-productions">Generators and Random Productions</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#combining-generators-and-constraints">Combining Generators and Constraints</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#when-to-use-generators-and-when-constraints">When to use Generators, and when Constraints</a></li>
</ul>
  </nav></div>

</div></div>
              
            
          </div>
          <footer class="bd-footer-content">
            
<div class="bd-footer-content__inner container">
  
  <div class="footer-item">
    
<p class="component-author">
By José Antonio Zamudio Amaya, Marius Smytzek, and Andreas Zeller
</p>

  </div>
  
  <div class="footer-item">
    

  <p class="copyright">
    
      © Copyright 2024 CISPA Helmholtz Center for Information Security (www.cispa.de). All Rights Reserved..
      <br/>
    
  </p>

  </div>
  
  <div class="footer-item">
    
  </div>
  
  <div class="footer-item">
    
  </div>
  
</div>
          </footer>
        

      </main>
    </div>
  </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script defer src="_static/scripts/bootstrap.js?digest=8878045cc6db502f8baf"></script>
<script defer src="_static/scripts/pydata-sphinx-theme.js?digest=8878045cc6db502f8baf"></script>

  <footer class="bd-footer">
  </footer>
  </body>
</html>